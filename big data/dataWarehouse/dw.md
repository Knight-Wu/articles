# 分层

## 参考
1. https://cloud.tencent.com/developer/article/1396891

## 简要概括

例如电商系统中，用户访问日志这一部分数据。

在ODS层中，由于各端的开发团队不同或者各种其它问题，用户的访问日志被分成了好几张表上报到了我们的ODS层。
</br>
为了方便大家的使用，我们在DWD层做了一张用户访问行为天表，在这里，我们将PC网页、H5、小程序和原生APP访问日志汇聚到一张表里面，统一字段名，提升数据质量，这样就有了一张可供大家方便使用的明细表了。
</br>
在DWM层，我们会从DWD层中选取业务关注的核心维度来做聚合操作，比如只保留人、商品、设备和页面区域维度。类似的，我们这样做了很多个DWM的中间表
</br>
然后在DWS层，我们将一个人在整个网站中的行为数据放到一张表中，这就是我们的宽表了，有了这张表，就可以快速满足大部分的通用型业务需求了。
</br>
最后，在APP应用层，根据需求从DWS层的一张或者多张表取出数据拼接成一张应用表即可

## 为什么要分层
1. 对应用的支持上来讲，越上层对应用越友好，越底层理解成本越高
2. 从能力范围来讲，80%的需求由20%的表来支持，大部分需求由DWS 的表支持，对于80%的需求都希望以对应用友好的方式来支持，而不是暴露给应用方原始日志的方式。
3. 从数据聚合的角度，越上层的数据聚合程度越高，可以理解为每行数据包含的信息越多，纬度越少，由多个底层数据聚合而成。ODS和DWD的数据基本是原始日志的粒度，不做任何聚合操作，DWM做了轻度的聚合操作只保留了通用的维度，DWS做了更高的聚合操作，可能只保留一到两个能表征当前描述主体的维度。从这个角度来看，我们又可以理解为我们是按照数据的聚合程度来划分数据层次的。